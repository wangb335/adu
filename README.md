# 🔍 ADU - 高级目录使用率工具

> ADU (Advanced Directory Usage) 是一个用于计算目录大小的 Shell 脚本工具，可以帮助您快速找出占用空间较大的目录。通过彩色输出和直观的数据展示，让您轻松管理磁盘空间！

---

## ✨ 功能特点

- 📊 计算指定目录的大小
- 🔢 支持自定义搜索深度
- 🚫 自动排除非目标挂载点
- 📏 只显示以 GB 为单位的目录（节省输出空间）
- 💾 支持将结果保存到文件中
- 🌈 丰富的彩色输出，提高可读性和用户体验
- 📈 清晰的进度提示和结果展示

---

## 📖 使用方法

```bash
# 基本用法
./adu.sh [目录路径] [深度] [选项]
```

### 📝 参数说明

| 参数 | 说明 | 默认值 |
|------|------|--------|
| `目录路径` | 要计算大小的目录 | `/` (根目录) |
| `深度` | 要搜索的目录深度 | `5` |
| `选项` | 附加功能选项 | - |

#### 🛠️ 可用选项

| 选项 | 说明 |
|------|------|
| `-h, --help` | 显示帮助信息 |
| `-s, --submit` | 将结果保存到文件 |

---

### 🌟 示例

1. 📂 计算根目录下深度为 3 的目录大小：
   ```bash
   # 分析根目录，深度为3
   ./adu.sh / 3
   ```

2. 🏠 计算 /home 目录下深度为 2 的目录大小：
   ```bash
   # 分析home目录，深度为2
   ./adu.sh /home 2
   ```

3. 📁 计算 /var 目录并将结果保存到文件：
   ```bash
   # 分析var目录，深度为3，并保存结果
   ./adu.sh /var 3 -s
   ```

4. ❓ 显示帮助信息：
   ```bash
   # 显示帮助
   ./adu.sh --help
   ```

---

## 🔄 工作流程

```mermaid
graph TD
    A[开始] --> B[解析命令行参数]
    B --> C{是否请求帮助?}
    C -->|是| D[显示帮助信息]
    C -->|否| E[设置目录和深度]
    E --> F[计算目录大小]
    F --> G{是否保存结果?}
    G -->|是| H[保存到文件]
    G -->|否| I[显示在终端]
    H --> J[结束]
    I --> J
    D --> J
```

---

## ⚠️ 注意事项

- 🔐 **脚本需要有足够的权限访问目标目录**
- ⏱️ **计算大型目录可能需要较长时间**
- 📄 **结果文件将保存在当前目录下，格式为：** `dir_size_YYYYMMDD_HHMMSS.txt`

---

## 📊 输出文件格式

| 字段 | 说明 |
|------|------|
| 计算开始时间 | 任务开始的日期和时间 |
| 目录 | 被分析的目录路径 |
| 深度 | 搜索的目录深度 |
| 大小 | 目录大小（GB） |
| 路径 | 目录的完整路径 |
| 计算结束时间 | 任务完成的日期和时间 |

---

## 🖥️ 实际运行示例

### 显示帮助信息

```bash
root@pts/1 $ sh 1 -h
^[[1;34m[2025-08-27 21:52:26.572] ADU - 高级目录使用率工具 v1.1 ^[[0m
^[[1;33m[2025-08-27 21:52:26.578] ====================================== ^[[0m
^[[1;34m[2025-08-27 21:52:26.584] === ADU - 高级目录使用率工具 === ^[[0m
^[[1;33m[2025-08-27 21:52:26.591] 用法: 1 [目录路径] [深度] [选项] ^[[0m
^[[1;34m[2025-08-27 21:52:26.598] 选项: ^[[0m
^[[1;32m[2025-08-27 21:52:26.606]   -h, --help     显示帮助信息 ^[[0m
^[[1;32m[2025-08-27 21:52:26.613]   -s, --submit   将结果保存到文件 ^[[0m
^[[1;34m[2025-08-27 21:52:26.619] 示例: ^[[0m
^[[1;34m[2025-08-27 21:52:26.627]   1 /home 3     计算/home目录下深度为3的目录大小 ^[[0m
^[[1;34m[2025-08-27 21:52:26.633]   1 /var 2 -s   计算/var目录下深度为2的目录大小并保存结果 ^[[0m
```

### 计算目录大小结果

```bash
root@pts/1 $ sh 1 /data 1
^[[1;34m[2025-08-27 21:52:48.224] ADU - 高级目录使用率工具 v1.1 ^[[0m
^[[1;33m[2025-08-27 21:52:48.228] ====================================== ^[[0m
^[[1;32m[2025-08-27 21:52:48.235] 目标目录: /data ^[[0m
^[[1;32m[2025-08-27 21:52:48.241] 搜索深度: 1 ^[[0m
^[[1;33m[2025-08-27 21:52:48.248] ====================================== ^[[0m
^[[1;34m[2025-08-27 21:52:48.270] 正在计算目录 /data 的大小，深度为 1 ^[[0m
^[[1;33m[2025-08-27 21:52:48.279] 时间可能较长，请耐心等待…… ^[[0m
^[[1;35m[2025-08-27 21:52:48.287] === 目录大小计算结果 === ^[[0m
^[[1;33m[2025-08-27 21:55:11.562] 90M /data/website ^[[0m
^[[1;31m[2025-08-27 21:55:11.567] 9.5G /data/SZT ^[[0m
^[[1;33m[2025-08-27 21:55:11.572] 23M /data/alading ^[[0m
^[[1;31m[2025-08-27 21:55:11.576] 147G /data/hc20 ^[[0m
^[[1;33m[2025-08-27 21:55:11.582] 26M /data/NFS ^[[0m
^[[1;31m[2025-08-27 21:55:11.588] 605G /data/fund ^[[0m
^[[1;31m[2025-08-27 21:55:11.592] 3.7G /data/nginx ^[[0m
^[[1;31m[2025-08-27 21:55:11.598] 9.9G /data/newguanwang ^[[0m
^[[1;31m[2025-08-27 21:55:11.604] 775G /data ^[[0m
^[[1;32m[2025-08-27 21:55:11.612] 目录大小计算结束 ^[[0m
^[[1;34m[2025-08-27 21:55:11.618] ====================================== ^[[0m
```

### 输出文件内容示例

```
计算开始时间: 2025-08-27 21:46:16
目录: /data/
深度: 1
----------------------------------------
143G	/data/hc20
3.7G	/data/nginx
147G	/data/
----------------------------------------
计算结束时间: 2025-08-27 21:46:19
```